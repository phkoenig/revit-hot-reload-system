# ğŸš€ REVIT HOT RELOAD ARCHITEKTUR - CHECKLISTE
# GeoJSON Importer - Hot Reload System
# ERSTELLT: 2024-12-19 (Funktionierende Architektur!)

## ğŸ—ï¸ ARCHITEKTUR-ÃœBERSICHT

### ğŸš¨ KRITISCHE ARCHITEKTUR-REGEL (NIEMALS VERLETZEN!)

**Die Loader-DLL (GeoJsonImporter.dll) ist NUR ein Dummy!**

#### âœ… **RICHTIG - Loader-DLL (GeoJsonImporter.dll):**
- **NUR Revit API Referenzen** (RevitAPI.dll, RevitAPIUI.dll)
- **KEINE Package References** (kein GeoJSON.Net, kein Newtonsoft.Json!)
- **NUR Dummy-Code:** App.cs, Proxy-Commands, WorkDllManager
- **Kann NICHT ausgetauscht werden** (statisch in Revit geladen)

#### âœ… **RICHTIG - Work-DLL (GeoJsonImporter.Work.dll):**
- **ALLE Package References** (GeoJSON.Net, Newtonsoft.Json, etc.)
- **ALLE echten Commands** (Business Logic)
- **Kann zur Laufzeit ausgetauscht werden** (Hot Reload fÃ¤hig)

#### âŒ **FALSCH - NIEMALS TUN:**
- **Package References in Loader-DLL hinzufÃ¼gen** (zerstÃ¶rt Architektur!)
- **Business Logic in Loader-DLL schreiben** (zerstÃ¶rt Hot Reload!)
- **Work-DLL Referenzen in Loader-DLL** (verursacht "Klasse nicht gefunden")

---

### Loader-DLL (GeoJsonImporter.dll)
- **EnthÃ¤lt:** UI-Management (App.cs) + Proxy-Commands + WorkDllManager + Load/Unload Commands
- **Zweck:** LÃ¤dt Work-DLL und delegiert Commands
- **Hot Reload:** Kann NICHT ausgetauscht werden

### Work-DLL (GeoJsonImporter.Work.dll)  
- **EnthÃ¤lt:** Alle echten Commands (Business Logic)
- **Zweck:** Implementiert die eigentliche FunktionalitÃ¤t
- **Hot Reload:** Kann zur Laufzeit ausgetauscht werden

## ğŸ”„ HOT RELOAD WORKFLOW

### 1. Entwicklung
1. **Work-DLL Code Ã¤ndern**
2. **Work-DLL neu bauen**
3. **"Unload Work-DLL" in Revit klicken**
4. **"Load Work-DLL" in Revit klicken**
5. **Neue FunktionalitÃ¤t testen**

### 2. Architektur
```
Revit â†’ App.cs â†’ Loader-DLL Proxy-Command â†’ WorkDllManager â†’ Work-DLL echte Commands
  â†“         â†“              â†“                    â†“              â†“
UI      Button    Loader-DLL (statisch)    Delegation    Business Logic (Hot Reload)
```

## âœ… ARCHITEKTUR-SCHNELLCHECK

### 1. Loader-DLL (GeoJsonImporter.csproj)
- [ ] EnthÃ¤lt: WorkDllManager.cs, LoadWorkDllCommand.cs, UnloadWorkDllCommand.cs
- [ ] EnthÃ¤lt Proxy-Commands: AbracadabraCommand.cs, SetupCommand.cs, ImportGeoJsonCommand.cs
- [ ] App.cs zeigt auf Loader-DLL Proxy-Commands

### 2. Work-DLL (GeoJsonImporter.Work.csproj)
- [ ] EnthÃ¤lt alle echten Commands: AbracadabraWorkCommand.cs, SetupWorkCommand.cs, ImportGeoJsonWorkCommand.cs
- [ ] Keine Referenzen auf Loader-DLL
- [ ] Alle Commands implementieren IExternalCommand

### 3. WorkDllManager
- [ ] LÃ¤dt Work-DLL in AssemblyLoadContext
- [ ] Delegiert Commands Ã¼ber spezifische Methoden (ExecuteAbracadabra, ExecuteWorkCommand)
- [ ] Keine generischen Methoden mit commandName Parameter

## ğŸš¨ VERBOTENE AKTIONEN

### âŒ NIEMALS:
1. **App.cs zeigt direkt auf Work-DLL Commands** (verursacht "Klasse nicht gefunden")
2. **WorkDllManager modifizieren** (neue generische Methoden)
3. **Work-DLL referenziert Loader-DLL**
4. **Generische ExecuteWorkCommand(string commandName, ...)** verwenden

### âœ… IMMER:
1. **Proxy-Commands in Loader-DLL** fÃ¼r alle FunktionalitÃ¤t
2. **Echte Commands in Work-DLL** implementieren
3. **App.cs zeigt auf Loader-DLL Proxy-Commands**
4. **Spezifische WorkDllManager-Methoden** verwenden

## ğŸ”§ BEHEBUNG VON PROBLEMEN

### "Klasse nicht gefunden" Fehler
1. **PrÃ¼fe:** Ist Proxy-Command in Loader-DLL vorhanden?
2. **PrÃ¼fe:** Zeigt App.cs auf den richtigen Proxy-Command?
3. **PrÃ¼fe:** Ist Work-DLL erfolgreich geladen?
4. **PrÃ¼fe:** Funktioniert WorkDllManager?

### Hot Reload funktioniert nicht
1. **PrÃ¼fe:** Sind Load/Unload Commands korrekt?
2. **PrÃ¼fe:** Ist WorkDllManager unverÃ¤ndert?
3. **PrÃ¼fe:** Sind alle Commands in der richtigen DLL?

## ğŸ“š DATEI-STRUKTUR

### Loader-DLL
```
src/GeoJsonImporter/Addin/
â”œâ”€â”€ App.cs (zeigt auf Proxy-Commands)
â”œâ”€â”€ Commands/
â”‚   â”œâ”€â”€ WorkDllManager.cs
â”‚   â”œâ”€â”€ LoadWorkDllCommand.cs
â”‚   â”œâ”€â”€ UnloadWorkDllCommand.cs
â”‚   â”œâ”€â”€ AbracadabraCommand.cs (Proxy)
â”‚   â”œâ”€â”€ SetupCommand.cs (Proxy)
â”‚   â””â”€â”€ ImportGeoJsonCommand.cs (Proxy)
```

### Work-DLL
```
src/GeoJsonImporter.Work/Commands/
â”œâ”€â”€ AbracadabraWorkCommand.cs (echt)
â”œâ”€â”€ SetupWorkCommand.cs (echt)
â””â”€â”€ ImportGeoJsonWorkCommand.cs (echt)
```

## ğŸ¯ FAZIT

**Proxy-Commands gehÃ¶ren in die Loader-DLL!**
- **App.cs** â†’ **Loader-DLL Proxy-Commands**
- **Proxy-Commands** â†’ **WorkDllManager** â†’ **Work-DLL echte Commands**
- **Das ist die korrekte Hot Reload Architektur!**

**WICHTIG: Verwende spezifische WorkDllManager-Methoden, keine generischen!**

---
*Erstellt nach der erfolgreichen Implementierung vom 19.12.2024*